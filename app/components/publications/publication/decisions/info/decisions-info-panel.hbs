<div class="auk-u-mb-3">
  <Auk::Panel class={{if this.isEditing "auk-panel--editing"}}>
    <Auk::Panel::Header>
      <Auk::Toolbar>
        <Auk::Toolbar::Group @position="left">
          <Auk::Toolbar::Item>
            <h4 class="auk-panel__title">
              {{t "publication-decisions-info-panel-title"}}
            </h4>
          </Auk::Toolbar::Item>
        </Auk::Toolbar::Group>
        {{#unless this.isEditing}}
          <Auk::Toolbar::Group @position="right">
            <Auk::Toolbar::Item>
              <Auk::Button
                data-test-decisions-info-panel-view-edit
                @skin="tertiary"
                @icon="pencil"
                @layout="icon-only"
                {{on "click" this.openEditingPanel}}
              />
            </Auk::Toolbar::Item>
          </Auk::Toolbar::Group>
        {{/unless}}
      </Auk::Toolbar>
    </Auk::Panel::Header>
    <Auk::Panel::Body>
      {{#if this.isEditing}}
        <Utils::LoadableContent
          @isLoading={{this.save.isRunning}}
          @reserveSpace={{true}}
        >
          <div class="auk-form-group-layout auk-form-group-layout--grid">
            <div class="auk-o-grid">

              {{! Type regelgeving }}
              <div class="auk-o-grid-col-3">
                <div
                  data-test-decisions-info-panel-edit-regulation-type
                  class="auk-form-group"
                >
                  <Auk::Label>
                    {{t "regulation-type"}}
                  </Auk::Label>
                  <PowerSelect
                    @options={{this.sortedRegulationTypes}}
                    @onChange={{fn (mut @publicationFlow.regulationType)}}
                    @selected={{@publicationFlow.regulationType}}
                    @allowClear={{true}}
                    as |regulationType|
                  >
                    {{regulationType.label}}
                  </PowerSelect>
                </div>
              </div>

              {{! Datum beslissing }}
              <div class="auk-o-grid-col-3">
                <div
                  data-test-decisions-info-panel-edit-decision-date
                  class="auk-form-group"
                >
                  <Auk::Label>{{t "decision-date"}}</Auk::Label>
                  {{#if (and this.isViaCouncilOfMinisters this.modelsForAgendaitemRoute)}}
                    <Auk::ButtonLink
                      target="_blank"
                      @icon="chevron-right"
                      @layout="icon-right"
                      @route="agenda.agendaitems.agendaitem"
                      @models={{this.modelsForAgendaitemRoute}}
                    >
                      {{#if @publicationFlow.agendaItemTreatment.startDate}}
                        {{moment-format @publicationFlow.agendaItemTreatment.startDate}}
                      {{else}}
                        {{t "to-agenda"}}
                      {{/if}}
                    </Auk::ButtonLink>
                  {{else}}
                    <Auk::Datepicker
                      @date={{this.agendaItemTreatment.startDate}}
                      @onChange={{set this.agendaItemTreatment "startDate"}}
                    />
                  {{/if}}
                </div>
              </div>

              {{! Number of pages }}
              <div class="auk-o-grid-col-3">
                <div
                  data-test-decisions-info-panel-edit-number-of-pages
                  class="auk-form-group"
                >
                  <Auk::Label>{{t "number-of-pages"}}</Auk::Label>
                  <Auk::Input
                    @type="number"
                    @block={{true}}
                    @value={{@publicationFlow.numberOfPages}}
                  />
                </div>
              </div>

              {{! Aantal uittreksels }}
              <div class="auk-o-grid-col-3">
                <div
                  data-test-decisions-info-panel-edit-number-of-extracts
                  class="auk-form-group"
                >
                  <Auk::Label>{{t "publication-flow-number-of-extracts"}}</Auk::Label>
                  <Auk::Input
                    @type="number"
                    @block={{true}}
                    @value={{@publicationFlow.numberOfExtracts}}
                  />
                </div>
              </div>
            </div>
          </div>
        </Utils::LoadableContent>
      {{else}}
        <div class="auk-o-grid">
          {{! Type regelgeving }}
          <div class="auk-o-grid-col-3">
            <div class="auk-content">
              <h4 class="auk-u-m-0">{{t "regulation-type"}}</h4>
              <p
                data-test-decisions-info-panel-view-regulation-type
                class="auk-u-m-0"
              >
                {{#if @publicationFlow.regulationType}}
                  {{@publicationFlow.regulationType.label}}
                {{else}}
                  {{t "dash"}}
                {{/if}}
              </p>
            </div>
          </div>

          {{! Datum beslissing}}
          <div class="auk-o-grid-col-3">
            <div class="auk-content">
              <h4 class="auk-u-m-0">{{t "decision-date"}}</h4>
              <p
                data-test-decisions-info-panel-view-decision-date
                class="auk-u-m-0"
              >
                {{#if (and this.isViaCouncilOfMinisters this.modelsForAgendaitemRoute)}}
                  <Auk::ButtonLink
                    data-test-decisions-info-panel-view-decision-link
                    target="_blank"
                    @icon="chevron-right"
                    @layout="icon-right"
                    @route="agenda.agendaitems.agendaitem"
                    @models={{this.modelsForAgendaitemRoute}}
                  >
                    {{#if @publicationFlow.agendaItemTreatment.startDate}}
                      {{moment-format @publicationFlow.agendaItemTreatment.startDate}}
                    {{else}}
                      {{t "to-agenda"}}
                    {{/if}}
                  </Auk::ButtonLink>
                {{else}}
                  {{#if @publicationFlow.agendaItemTreatment.startDate}}
                    {{moment-format @publicationFlow.agendaItemTreatment.startDate}}
                  {{else}}
                    {{t "dash"}}
                  {{/if}}
                {{/if}}
              </p>
            </div>
          </div>

          {{! Number of pages }}
          <div class="auk-o-grid-col-3">
            <div class="auk-content">
              <h4 class="auk-u-m-0">{{t "number-of-pages"}}</h4>
              <p
                data-test-decisions-info-panel-view-number-of-pages
                class="auk-u-m-0"
              >
                {{#if @publicationFlow.numberOfPages}}
                  {{@publicationFlow.numberOfPages}}
                {{else}}
                  {{t "dash"}}
                {{/if}}
              </p>
            </div>
          </div>

          {{! Aantal uittreksels }}
          <div class="auk-o-grid-col-3">
            <div class="auk-content">
              <h4 class="auk-u-m-0">{{t "publication-flow-number-of-extracts"}}</h4>
              <p
                data-test-decisions-info-panel-view-number-of-extracts
                class="auk-u-m-0"
              >
                {{#if @publicationFlow.numberOfExtracts}}
                  {{@publicationFlow.numberOfExtracts}}
                {{else}}
                  {{t "dash"}}
                {{/if}}
              </p>
            </div>
          </div>
        </div>
      {{/if}}
    </Auk::Panel::Body>
    {{#if this.isEditing}}
      <Auk::Panel::Footer>
        <Auk::Toolbar>
          <Auk::Toolbar::Group @position="left">
            <Auk::Toolbar::Item>
              <Auk::Button
                data-test-decisions-info-panel-edit-cancel
                @skin="borderless"
                @disabled={{or
                  this.closeEditingPanel.isRunning
                  this.save.isRunning
                }}
                {{on "click" (perform this.closeEditingPanel)}}
              >
                {{t "cancel"}}
              </Auk::Button>
            </Auk::Toolbar::Item>
          </Auk::Toolbar::Group>
          <Auk::Toolbar::Group @position="right">
            <Auk::Toolbar::Item>
              <Auk::Button
                data-test-decisions-info-panel-edit-save
                @skin="primary"
                @loading={{this.save.isRunning}}
                @disabled={{or
                  (not this.isValid)
                  this.closeEditingPanel.isRunning
                }}
                {{on "click" (perform this.save)}}
              >
                {{t "save"}}
              </Auk::Button>
            </Auk::Toolbar::Item>
          </Auk::Toolbar::Group>
        </Auk::Toolbar>
      </Auk::Panel::Footer>
    {{/if}}
  </Auk::Panel>
</div>