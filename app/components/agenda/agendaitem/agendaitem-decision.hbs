
<div data-test-agendaitem-decision-container>
  <div class="vlc-document-card vlc-document-card--header auk-u-bg-alt">
    <div class="vlc-document-card__summary">
      <div class="vlc-document-card__content">
        <Auk::Toolbar @auto={{true}}>
          <Auk::Toolbar::Group @position="left">
            <Auk::Toolbar::Item class="auk-content">
              <h4>{{t "util.decision-result" }}</h4>
              {{#if (not this.isEditing)}}
              <div class="auk-o-flex">
                {{#if @treatment.decisionResultCode}}
                  <Decision::DecisionResultPill
                    @decisionResultCode={{@treatment.decisionResultCode}}
                  />
                {{else}}
                <Auk::Pill>
                  {{t "util.no-decision-set"}}
                </Auk::Pill>
                {{/if}}
                {{#if this.currentSession.isEditor}}
                  <Auk::Button
                    @skin="tertiary"
                    @icon="pencil"
                    class="auk-button--tiny"
                      @layout="icon-only"
                    {{on "click" this.openEditingWindow}}
                    data-test-agendaitem-decision-edit
                  >
                    {{t "edit"}}
                  </Auk::Button>
                {{/if}}
              </div>
              {{else}}
                <Agenda::Agendaitem::AgendaitemDecisionEdit
                  @agendaItemTreatment={{@treatment}}
                  @onSave={{this.closeEditingWindow}}
                  @onCancel={{this.closeEditingWindow}}
                  @isTableRow={{@isTableRow}}
                />
              {{/if}}
            </Auk::Toolbar::Item>
          </Auk::Toolbar::Group>
          <Auk::Toolbar::Group @position="right">
            <Auk::Toolbar::Item>
              {{#if this.currentSession.isEditor}}

                {{#if @allowDelete}}
                  <DropdownMenu
                    @skin="borderless"
                    @icon="three-dots"
                  as |Menu|>
                    <Menu.Item
                      @skin="danger"
                      data-test-agendaitem-decision-delete
                      {{on "click" (fn this.promptDeleteTreatment @treatment)}}
                    >
                      {{t "delete-decision"}}
                    </Menu.Item>
                  </DropdownMenu>
                {{/if}}
              {{/if}}
            </Auk::Toolbar::Item>
          </Auk::Toolbar::Group>
        </Auk::Toolbar>

      </div>
    </div>
  </div>
</div>
{{#if this.loadReport.isIdle}}
  {{#if this.report}}
    <Documents::DocumentCard
      @piece={{this.report}}
      @hideNewerVersions={{true}}
      @onOpenUploadModal={{@onOpenUploadModal}}
      @onAddPiece={{perform this.attachNewReportVersion}}
      @didDeletePiece={{perform this.attachPreviousReportVersion}}
      @didDeleteContainer={{perform this.loadReport}}
    />
  {{else}}
    {{#if this.currentSession.isEditor}}
    <div class="vlc-document-card">
      <div class="vlc-document-card__summary">
        <div class="vlc-document-card__content">
          <Auk::Button
            @skin="borderless"
            @icon="upload"
            {{on "click" this.toggleIsAddingReport}}
            data-test-agendaitem-decision-upload-file
          >
            {{t "signed-decision-add"}}
          </Auk::Button>
        </div>
      </div>
    </div>
    {{/if}}
  {{/if}}
{{else}}
  <Auk::Loader />
{{/if}}
{{#if this.isVerifyingDelete}}
  <WebComponents::VlModalVerify
    @title={{t "delete-decision"}}
    @message={{t "delete-decision-message"}}
    @cancel={{this.cancel}}
    @verify={{this.deleteTreatment}}
  />
{{/if}}
{{#if this.isAddingReport}}
  <Utils::AddDocument
    @title={{t "signed-decision-add"}}
    @onSave={{this.attachReport}}
    @onCancel={{this.toggleIsAddingReport}}
  />
{{/if}}