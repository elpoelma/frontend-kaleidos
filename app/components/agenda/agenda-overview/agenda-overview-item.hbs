<div {{in-viewport onEnter=this.onEnter onExit=this.onExit}} class={{classNameBindings}}>
  <div class="vlc-agenda-items__body ">
    <h4 class="vlc-agenda-items__subject">
      {{#if
        (and this.currentSessionService.isEditor this.currentAgenda.isDesignAgenda)
      }}
        <div class="vlc-agenda-items__cursor">
          <WebComponents::AuButton class="auk-u-p-0" @skin="borderless">
            <WebComponents::AuIcon @name="drag-handle-2" @grab={{true}}/>
          </WebComponents::AuButton>
        </div>
      {{/if}}
      <span class="vlc-agenda-items-sub-item__numbering">
        {{#if @agendaitem.number}}
          {{@agendaitem.number}}.
        {{else}}
          {{add index 1}}.
        {{/if}}
      </span>
    </h4>
    <div class="vlc-agenda-items__text">
      <div class="auk-u-flex">
        <div class="left_side">
          <h4 class="vlc-agenda-items__subject">
            <LinkTo
              data-test-agenda-overview-sub-item
              @route="agenda.agendaitems.agendaitem"
              @model={{@agendaitem}}
            >
              <pre class="auk-u-text-pre-line">
                {{#if @agendaitem.shortTitle}}
                  {{@agendaitem.shortTitle}}
                {{else}}
                  {{@agendaitem.title}} {{!-- Fallback for legacy data that doesn't have a short title --}}
                {{/if}}
              </pre>
            </LinkTo>
          </h4>

          {{#if (not aboutToDelete)}}
            {{#if (not selectedAgendaitem)}}
              {{#if (not @agendaitem.isApproval)}}
                {{#if @agendaitem.shortTitle}} {{!-- Avoid rendering the same thing twice if no "shortTitle" exists --}}
                  <pre class="vlc-agenda-items__body-padding auk-u-text-pre-line">
                    {{@agendaitem.title}}
                  </pre>
                {{/if}}
              {{/if}}
            {{/if}}
          {{/if}}

        </div>

        {{!--  TODO: Commented out section triggers many requests that slow down agenda overview
        <div class="vlc-u-flex-float-right">
        {{#if currentSessionService.isOvrb}}

                   PUBLICATION FLOW CALL TO ACTION

          <div class="vlc-u-flex-float-right">

                     PUBLICATION FLOW CALL TO ACTION

            {{#if (not @isEditingOverview)}}
              <div class="auk-button-toolbar">
                {{#if (await @agendaitem.publicationFlow)}}
                  <LinkTo
                          class=""
                          @route="publications.publication"
                          @model={{ await @agendaitem.publicationFlowId }}
                  >
                    {{t "publications-to" }}
                  </LinkTo>
                {{else}}
                  {{#if (await @agendaitem.case)}}
                    <WebComponents::AuButton
                            @skin="tertiary"
                            @layout="icon-only"
                            data-test-start-publication
                      {{on "click" this.startPublication}}>
                      {{t "start-publication"}}
                    </WebComponents::AuButton>
                  {{/if}}
                {{/if}}
              </div>
            {{/if}}

                   END  PUBLICATION FLOW CALL TO ACTION

          </div>
        {{/if}}

                 END  PUBLICATION FLOW CALL TO ACTION

        </div>
        --}}
      </div>


      {{#if (not aboutToDelete)}}
        {{#if (or renderDetails @isEditingOverview)}}
          <div class="auk-u-flex auk-u-flex--justify-between">
            {{#if (and selectedAgendaitem @isEditingOverview)}}
              <WebComponents::AuPill class="vlc-agenda-meta__times-passed auk-u-text-capitalize"></WebComponents::AuPill>
            {{else}}
              {{#if subcase.subcaseName}}
                <WebComponents::AuPill class="vlc-agenda-meta__times-passed auk-u-text-capitalize">{{subcase.subcaseName}}</WebComponents::AuPill>
              {{else}}
                <span class="vlc-agenda-meta__times-passed auk-u-text-capitalize"></span>
              {{/if}}
            {{/if}}
            <div class="vlc-agenda-meta__status-holder">
              {{#if
                (and
                  currentSessionService.isEditor
                  (await currentAgenda.isDesignAgenda)
                )
              }}
                {{#if (not @isEditingOverview)}}
                  {{#if @agendaitem.formallyOkToShow.approved}}
                    <p class="{{@agendaitem.formallyOkToShow.classNames}}">
                      <i class="{{@agendaitem.formallyOkToShow.iconClassNames}}" aria-hidden="true"></i>
                      {{@agendaitem.formallyOkToShow.label}}
                    </p>
                  {{else}}
                    <p class="{{@agendaitem.formallyOkToShow.classNames}}">
                      <i class="{{@agendaitem.formallyOkToShow.iconClassNames}}" aria-hidden="true"></i>
                      {{@agendaitem.formallyOkToShow.label}}
                    </p>
                  {{/if}}
                {{else}}
                  <Utils::FormallyOkSelector
                          @formallyOk={{formallyOk}}
                          @isLoading={{isLoading}}
                          @hideLabel={{hideLabel}}
                          @setAction={{action "setAction"}} />
                {{/if}}
              {{/if}}
            </div>
          </div>
          {{#if (not aboutToDelete)}}
            {{#if (not selectedAgendaitem)}}
              {{#if overheidCanViewDocuments}}
                {{#if renderDetails}}
                  {{#if (await @agendaitem.pieces)}}
                    <div class="vlc-hr"></div>
                    <Utils::PiecesListForItem
                      @isClickable={{true}}
                      @pieces={{await @agendaitem.pieces}}
                    />
                  {{else}}
                    {{#if (await @agendaitem.pieceNames)}}
                      <div class="vlc-hr"></div>
                      <Utils::PiecesListLazyLoaded
                       @pieceNames={{await @agendaitem.pieceNames}}
                      />
                    {{/if}}
                  {{/if}}
                {{else}}
                  {{#if (await @agendaitem.pieceNames)}}
                    <div class="vlc-hr"></div>
                    <Utils::PiecesListLazyLoaded
                      @pieceNames={{await @agendaitem.pieceNames}}
                    />
                  {{/if}}
                {{/if}}
              {{/if}}
            {{/if}}
          {{/if}}
          {{#if (not @isEditingOverview)}}
            {{#if currentSessionService.isViewer}}
              {{#if
                (or subcase.confidential (or (await @agendaitem.checkAdded) (or @agendaitem.explanation (not newsletterInfo.inNewsletter))))
              }}
                <div class="vlc-hr"></div>
              {{/if}}
              <div class="vlc-agenda-items__remarks">
                <div>
                  {{#if @agendaitem.explanation}}
                    <span class="auk-u-text-bold">
                      {{t "remark-title"}}:
                    </span> {{@agendaitem.explanation}}
                  {{/if}}
                </div>
                <div class="vlc-agenda-items__icons">
                  <div class="auk-u-flex vlc-agenda-items__icons">
                    {{#if (not newsletterInfo.inNewsletter)}}
                      <div class="auk-icon auk-icon--default vlc-u-opacity-50 auk-u-ml-2 opacity-lighter">
                        <i class="ki ki-hide"></i>
                        <EmberTooltip @side="top" @tooltipClass="tooltip-custom">
                          <p>
                            {{t "not-visible-in-newsletter"}}
                          </p>
                        </EmberTooltip>
                      </div>
                    {{/if}}
                    {{#if (await @agendaitem.checkAdded)}}
                      <div class="auk-icon auk-icon--default vlc-agenda-item__icons--margin">
                        <i class="ki ki-calendar-plus"></i>
                        <EmberTooltip @side="top" @tooltipClass="tooltip-custom">
                          <p>
                            {{t "added-agendaitem-text"}}
                          </p>
                        </EmberTooltip>
                      </div>
                    {{/if}}
                  </div>
                  {{#if subcase.confidential}}
                    <span class="vlc-agenda-items__confidentiality-button vlc-pill vlc-pill--error">
                      <div class="auk-icon auk-icon--default vlc-agenda-items__icons" data-test-icon-agenda-confidentiality-locked>
                        <i class="ki ki-lock-closed"></i>
                      </div>
                      {{t "confidential"}}
                    </span>
                  {{/if}}
                </div>
              </div>
            {{/if}}
          {{/if}}
        {{/if}}
      {{/if}}
    </div>
  </div>
</div>

{{!-- LOADER --}}

{{#if this.showLoader}}
  <WebComponents::AuLoadingOverlay/>
{{/if}}