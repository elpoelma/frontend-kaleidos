<div class="vlc-document-card auk-u-mb-2" data-test-document-card>
  <div class="vlc-document-card__summary">
    <div class="vlc-document-card__badge">
      <div class="vl-badge vl-badge--icon vl-badge--alt vl-badge--small-medium">
        <i class="vl-badge__icon ki-document" aria-hidden="true"></i>
      </div>
    </div>
    <div class="vlc-document-card__content">
      <div class="vlc-toolbar vlc-toolbar--auto">
        <div class="vlc-toolbar__left">
          <div class="vlc-toolbar__item">
            <p class="vlc-subline" data-test-linkeddocument-type-label>
              {{@documentContainer.type.label}}
            </p>
          </div>
        </div>
        <div class="vlc-document-card-toolbar__right">
          <div class="vlc-toolbar__item">
            {{#if this.lastPiece}}
              <AccessLevelPill
                @accessLevel={{this.accessLevel}}
                @confidential={{this.lastPiece.confidential}}
                @onChangeAccessLevel={{this.changeAccessLevel}}
                @onConfirmChangeAccessLevel={{this.saveAccessLevel}}
                @onCancelChangeAccessLevel={{this.reloadAccessLevel}}
                @onChangeConfidentiality={{this.changeConfidentiality}}
              />
            {{/if}}
          </div>
          <div class="vlc-toolbar__item">
            {{#if currentSession.isEditor}}
              <button class="auk-button auk-button--muted-borderless auk-button--icon"
                type="button"
                {{on "click" this.deletePieceLink}}
              >
                <WebComponents::AuIcon @name="link-broken" @iconSkinColor="danger" />
              </button>
            {{/if}}
          </div>
        </div>
      </div>
      <h6 class="auk-h4">
        {{this.lastPiece.name}}
      </h6>
      <div class="vlc-document-card-content__meta">
        {{t "uploaded-at"}}
        {{moment-format this.lastPiece.created}}
        {{t "at"}}
        {{moment-format this.lastPiece.created "HH:mm"}}
      </div>
    </div>
  </div>
  {{#if this.reverseSortedPieces.length}}
    <div class="vlc-document-card__more">
      <div class="js-vl-accordion {{if this.isExpandedVersionHistory "js-vl-accordion--open"}}">
        <WebComponents::AuButton
          @skin="borderless"
          @icon={{if this.isExpandedVersionHistory "chevron-down" "chevron-right"}}
          data-test-show-pieces-history
          {{on "click" this.toggleVersionHistory}}
        >
          {{t "show-pieces"}}
        </WebComponents::AuButton>
        {{#if this.isExpandedVersionHistory}}
          <div class="vl-accordion__content js-vl-accordion__content">
            <div class="vl-accordion__panel">
              {{#each this.reverseSortedPieces as |piece|}}
                <WebComponents::VlDocument
                  @piece={{piece}}
                  @didUpdateAccessLevel={{perform this.loadData}}
                />
              {{/each}}
            </div>
          </div>
        {{/if}}
      </div>
    </div>
  {{/if}}
</div>

{{#if this.isOpenVerifyDeleteModal}}
  <WebComponents::VlModalVerify
    @title={{t "document-unlink"}}
    @message={{t "unlink-document-message"}}
    @cancel={{this.cancelDeletePieceLink}}
    @verify={{this.verifyDeletePieceLink}}
    @verifyButtonText={{t "unlink"}} />
{{/if}}