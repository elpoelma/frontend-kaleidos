<div class="auk-u-m-4">
  <Auk::KeyValue
    data-test-document-preview-details-name
    @key={{t "document-name"}}
  >
    {{#if this.isEditingDetails}}
      <Textarea
        data-test-document-preview-details-editor-name
        aria-labelledby="piece-name"
        class="auk-textarea"
        @value={{mut @piece.name}}
      />
    {{else}}
      {{@piece.name}}
    {{/if}}
  </Auk::KeyValue>
  {{#if (or this.documentType this.isEditingDetails)}}
    <Auk::KeyValue
      data-test-document-preview-details-document-type
      @key={{t "document-type"}}
    >
      {{#if this.isEditingDetails}}
        <Utils::ModelSelector
          data-test-document-preview-details-editor-document-type
          @modelName="document-type"
          @allowClear={{true}}
          @searchField="label"
          @propertyToShow="label"
          @sortField="priority"
          @selectedItems={{this.documentType}}
          @selectModel={{this.setDocumentType}}
        />
      {{else}}
        {{this.documentType.label}}
      {{/if}}
    </Auk::KeyValue>
  {{/if}}
  <Auk::KeyValue 
    data-test-document-preview-details-acces-level
    @key={{t "publicity"}}
  >
    {{#if this.isEditingDetails}}
      <Utils::ModelSelector
        data-test-document-preview-details-editor-acces-level
        @modelName="access-level"
        @allowClear={{true}}
        @hideSearch={{true}}
        @propertyToShow="label"
        @sortField="priority"
        @selectedItems={{this.accessLevel}}
        @selectModel={{this.setAccessLevel}}
      />
    {{else}}
      <Utils::AccessLevelColorBadge @accessLevel={{this.accessLevel}} />
    {{/if}}
  </Auk::KeyValue>
  <Auk::KeyValue
    data-test-document-preview-details-confidentiality
    @key={{capitalize (t "confidentiality")}}
  >
    {{#if this.isEditingDetails}}
      <Auk::Toggle
        data-test-document-preview-details-editor-confidentiality
        @checked={{mut @piece.confidential}}
      />
    {{else}}
      <Utils::ConfidentialityPill @confidential={{@piece.confidential}} />
    {{/if}}
  </Auk::KeyValue>
  <Auk::KeyValue @key={{t "file-type"}}>
    <Utils::Documents::FileTypePill
      data-test-document-preview-details-file-type
      @extension={{@piece.file.extension}}
    />
  </Auk::KeyValue>
  {{#if this.currentSession.isEditor}}
    <Auk::Toolbar as |toolbar|>
      <toolbar.Group @position="right" as |group|>
        {{#if this.isEditingDetails}}
          <group.Item>
            <Auk::ButtonLink
              data-test-document-preview-details-cancel
              @disabled={{this.isProcessing}}
              @loading={{this.cancelEditDetails.isRunning}}
              {{on "click" (perform this.cancelEditDetails)}}
            >
              {{t "cancel"}}
            </Auk::ButtonLink>
          </group.Item>
          <group.Item>
            <Auk::Button
              data-test-document-preview-details-save
              @skin="primary"
              @disabled={{this.isProcessing}}
              @loading={{this.saveDetails.isRunning}}
              {{on "click" (perform this.saveDetails)}}
            >
              {{t "save"}}
            </Auk::Button>
          </group.Item>
        {{else}}
          <group.Item>
            <Auk::Button
              data-test-document-preview-details-edit
              @skin="tertiary"
              @icon="pencil"
              {{on "click" this.openEditDetails}}
            >
              {{t "edit-2"}}
            </Auk::Button>
          </group.Item>
        {{/if}}
      </toolbar.Group>
    </Auk::Toolbar>
  {{/if}}
</div>